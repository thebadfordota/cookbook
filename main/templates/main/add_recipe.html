{% extends 'main/base.html' %}
{% block title %} {{ title }} {% endblock %}
{% block script %}

    {% if count_ingredients == 0 %}
        count_ingredients = 0;

    {% else %}
        count_ingredients = {{len}};
    {% endif %}

    function check_table(){
      tbody_table = document.getElementById("tbody_table_ingredients").innerHTML
      last_N = document.getElementById("N"+count_ingredients).value;
      last_V = document.getElementById("V"+count_ingredients).value;
      if (last_N != "" && last_V != ""){
        count_ingredients += 1;
        document.getElementById("T"+count_ingredients).style.display = "block";
      }

    }
{% endblock %}
{% block content %}
<h1>{{ heading }}</h1>
<div class="main_welcom">
    <h2 align = "center">Добавить рецепт</h2>
    <p>
    {% for a in error %}
        {{a}}<br/>
    {% endfor %}
    <form action="/recipe/add_ricipe" method = "POST" enctype="multipart/form-data">
        {% csrf_token %}
        Название <input type="text" name = "name" value = "{{old_result.name}}"><br/>
        Сделать рецепт публичным <input type ="checkbox" name = "public" {{ old_result.public }}> <br/>
        Ссылка на видео в юутубе <input type="text" name = "url_video" value="{{  old_result.url_video }}"> <br/>
        Тип
        <select name = "meal">
            {% for a in meal %}
                 {% if a == old_result.meal_type %}
                     <option value="{{a}}" selected>{{a}}</option>
                {% else %}
                    <option value="{{a}}">{{a}}</option>
                {% endif %}
            {% endfor %}

        </select>
        <br/>
        Картинка <input type="file" name = "image">
        <br/>
        Инструкция
        <br/>
        <textarea cols = 80 maxlength = 4000 name = "text" rows = 15 wrap="hard" style="resize: none;">
            {{old_result.text}}
        </textarea>
        <br/>
        Время готовки
        Часы

        <input type="number" min = 0 max = 10 value = "{{ old_result.hours }}{{ hours }}" size = 10 name="time_hour"><br/>
        Минуты
        <input type="number" min = 0 max = 59 value = "{{ old_result.minutes }}{{ minutes }}" size = 10 name="time_minutes"><br/>
        Сложность
        <select name = "complexity">

            <option value="1" selected>Очень легко</option>
            {% if old_result.complexity == '2' %}
                <option value="2" selected>Легко</option>
            {% else %}
                <option value="2" >Легко</option>
            {% endif %}

            {% if old_result.complexity == '3' %}
                <option value="3" selected>Средне</option>
            {% else %}
                <option value="3" >Средне</option>
            {% endif %}


            {% if old_result.complexity == '4' %}
                <option value="4" selected>Сложно</option>
            {% else %}
                <option value="4" >Сложно</option>
            {% endif %}


            {% if old_result.complexity == '5' %}
                <option value="5" selected>Очень сложно</option>
            {% else %}
                <option value="5" >Очень сложно</option>
            {% endif %}

        </select>

        <br/>
        Используемые ингридиенты на одну порцию блюда
        <table class="table table-striped table-hover"  >
            <thead>
                <tr>
                    <th scope="col">Ингридиент</th>
                    <th scope="col">Вес в граммах</th>
                </tr>
            </thead>

                <tbody id = "tbody_table_ingredients" onclick="check_table()" >
                {% if len >= 0 %}

                    {% for a in ingredients %}
                        <tr style = "display: block;">
                            <!-- id_name, name,id_value, value -->
                            <!-- name --> <td> <input type="input"   id = "{{ a.id_name }}" name = "{{ a.id_name }}" value = "{{ a.name}}" oninput="check_table()">  </td>
                            <!-- value --> <td><input type="number" min = 1   size = 10 id = "{{ a.id_value }}" name = "{{ a.id_value }}" value = "{{ a.value }}" oninput="check_table()">  </td>
                        </tr>
                    {% endfor %}

                    {% for a in new_input %}
                        <!-- ["T"+str(a), 'N'+str(a), 'V'+str(a)] -->
                        <tr style = "display: none;" id = "{{a.id_tr}}">
                            <td> <input type="input"   id = "{{a.id_name}}" name = "{{a.id_name}}" oninput="check_table()">  </td>
                            <td><input type="number" min = 1  size = 10 id = "{{a.id_value}}" name = "{{a.id_value}}" oninput="check_table()">  </td>
                        </tr>
                    {% endfor %}
                {% else %}

                    {% for a in 30|get_range %}
                        {# вывод всех полоей для ввода ингридиентов #}
                       {% include 'main/auxiliary templates/empty_ingredients.html' %}
                    {% endfor %}
                {% endif %}
                </tbody>
        </table>
        <input type="submit" >
    </form>
    </p>

</div>
{% endblock %}
