{% extends 'main/base.html' %}
{% block title %} {{ title }} {% endblock %}

{% block content %}
<h1>{{ heading }}</h1>
<div class="main_welcom">
    <form method="post" class="box">
        {% csrf_token %}
        <input type="hidden" name="form_type" value="form_1">
        {{ form.selection_field }}
        <div class="mb-3">
            <button type="submit" class="btn btn-success" name="">Отфильтровать</button>
        </div>
    </form>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th scope="col">Название</th>
                <th scope="col">Тип</th>
                <th scope="col">Сложность</th>
                <th scope="col">Время готовки</th>
                <th scope="col">Ваш рейтинг</th>
            </tr>
        </thead>
        <tbody>
            {% for el in all_recipe %}

            <tr>
                <td><a href="{% url 'view_recipe' el.pk %}">{{ el.name }}</a></td>
                <td>{{ el.meal_type }}</td>

                {% for curr_type in all_typing %}
                {% if curr_type.recipe_id == el %}
                    <td>{{ curr_type.complexity }}</td>
                    <td>{{ curr_type.cooking_time }}</td>
                {% endif %}
                {% endfor %}

                {% for curr_rate in all_rating %}
                    {% if curr_rate.recipe_id == el %}
                        {% if curr_rate.rating == None %}
                            <td>Нет оценки</td>
                        {% else %}
                         <td>{{ curr_rate.rating }}</td>
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
